<p>목표:&nbsp;ubuntu 14.03에서 HLS 서버를 만들어 단말에서 스트리밍 동작 테스트를 함</p><p><br></p><p>1. ffmpeg 다운로드 및 설치</p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;git&nbsp;clone&nbsp;git://source.ffmpeg.org/ffmpeg.git&nbsp;ffmpeg</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;cd&nbsp;ffmpeg</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;./configure</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;make</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;make&nbsp;install</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4f; text-decoration:none" class="con_link">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>
<p><br></p><p>2. lighttpd 설치 및 환경설정</p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;atp-get&nbsp;install&nbsp;lighttpd</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;vi&nbsp;/etc/lighttpd/lighttpd.conf</div></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>
<p><br></p><p>필요하다면, Server의 root directory와 port 번호를 수정</p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">server.modules&nbsp;=&nbsp;(</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mod_access",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mod_alias",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mod_compress",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mod_redirect",</div><div style="padding:0 6px; white-space:pre; line-height:130%">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mod_rewrite",</div><div style="padding:0 6px; white-space:pre; line-height:130%">)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.document-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"/home/user/www"</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.upload-dirs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(&nbsp;"/var/cache/lighttpd/uploads"&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.errorlog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"/var/log/lighttpd/error.log"</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.pid-file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"/var/run/lighttpd.pid"</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"www-data"</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.groupname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"www-data"</div><div style="padding:0 6px; white-space:pre; line-height:130%">server.port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8080&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">index-file.names&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(&nbsp;"index.php",&nbsp;"index.html",&nbsp;"index.lighttpd.html"&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">url.access-deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(&nbsp;"~",&nbsp;".inc"&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">static-file.exclude-extensions&nbsp;=&nbsp;(&nbsp;".php",&nbsp;".pl",&nbsp;".fcgi"&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">compress.cache-dir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"/var/cache/lighttpd/compress/"</div><div style="padding:0 6px; white-space:pre; line-height:130%">compress.filetype&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(&nbsp;"application/javascript",&nbsp;"text/css",&nbsp;"text/html",&nbsp;"text/plain"&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">#&nbsp;default&nbsp;listening&nbsp;port&nbsp;for&nbsp;IPv6&nbsp;falls&nbsp;back&nbsp;to&nbsp;the&nbsp;IPv4&nbsp;port</div><div style="padding:0 6px; white-space:pre; line-height:130%">##&nbsp;Use&nbsp;ipv6&nbsp;if&nbsp;available</div><div style="padding:0 6px; white-space:pre; line-height:130%">#include_shell&nbsp;"/usr/share/lighttpd/use-ipv6.pl&nbsp;"&nbsp;+&nbsp;server.port</div><div style="padding:0 6px; white-space:pre; line-height:130%">include_shell&nbsp;"/usr/share/lighttpd/create-mime.assign.pl"</div><div style="padding:0 6px; white-space:pre; line-height:130%">include_shell&nbsp;"/usr/share/lighttpd/include-conf-enabled.pl"</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4f; text-decoration:none" class="con_link">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>


<p><br></p><p>3. lighttpd 서버 실행 / 중지 /&nbsp;재시작</p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;/etc/init.d/lighttpd&nbsp;start</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;/etc/init.d/lighttpd&nbsp;stop</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;/etc/init.d/lighttpd&nbsp;restart</div></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>
<p><br></p>
<p>3. segmenter 오픈소스 다운로드 및 설치</p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;git&nbsp;clone&nbsp;<a href="https://github.com/johnf/m3u8-segmenter.git" target="_blank" class="con_link">https://github.com/johnf/m3u8-segmenter.git</a></div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;cd&nbsp;m3u8-segmenter</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;aclocal</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;automake&nbsp;-ac</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;autoconf</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;./configure</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;make</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;sudo&nbsp;make&nbsp;install</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4f; text-decoration:none" class="con_link">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>
<p><br></p><p>4. segmenter 실행</p><p><br></p><p><span style="color: rgb(255, 0, 0);">참고: HLS 규격에서 지원하는 비디오 오디오 코덱은 H.264/AAC 임. segmenter 폴더의 tests 아래 샘플 비디오가 있지만 HLS에서 지원하지 않는 코덱 형식이므로, 인코더를 사용하여 H.264/AAC로 변경하면 테스트에 용이함. (아이폰이나 일부 Android 단말에서는 H.246/AAC 코덱이 아닌경우 재생 불가)</span></p><p><br></p><p>테스트를 용이하게 하기위해 컴파일 결과로 생성된 m3u8-segmenter 파일과 영상파일 big_buck_bunny.mp4 파일을 lighttpd의 root directory로 이동했음</p><p><br></p>
<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #4f4f4f"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#aaa; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;cd&nbsp;$YOUR_ROOT_SERVER_DIR</div><div style="padding:0 6px; white-space:pre; line-height:130%">$&nbsp;ffmpeg&nbsp;-loglevel&nbsp;quiet&nbsp;&nbsp;-i&nbsp;big_buck_bunny.mp4&nbsp;-f&nbsp;mpegts&nbsp;-&nbsp;|&nbsp;m3u8-segmenter&nbsp;\</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;-i&nbsp;-&nbsp;-d&nbsp;10&nbsp;-p&nbsp;big_buck_bunny&nbsp;-m&nbsp;big_buck.m3u8&nbsp;-u&nbsp;<a href="http://192.168.111.40:8080/" target="_blank" class="con_link">http://192.168.111.40:8080/</a></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4f; text-decoration:none" class="con_link">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white" class="con_link"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div>
<p><br></p>
<p>4. 실행</p>
<p>안드로이드: MXPlayer의 네트워크스트림 이용하여 <a href="http://192.168.111.40:8080/big_buck.m3u8로" target="_blank" class="con_link">http://192.168.111.40:8080/big_buck.m3u8로</a> 접속</p><p>아이폰: 곰플레이어의 URL 이용하여&nbsp;<span style="line-height: 1.5;"><a href="http://192.168.111.40:8080/big_buck.m3u8로" target="_blank" class="con_link">http://192.168.111.40:8080/big_buck.m3u8로</a> 접속</span></p><p><span style="line-height: 1.5;"><br></span></p><p>192.168.111.40 --&gt; Ubuntu 서버의 주소</p><p>Device는 같은 서브넷에 접속되어야 함</p><p><span style="line-height: 1.5;"><br></span></p><p style="text-align: center;" align="center"><span style="line-height: 1.5;"><img id="se_object_1446098009639" src="IMG_3280.JPG" class="__se_object" s_type="attachment" s_subtype="photo" style=" width:320px; height:320px; rwidth:320px; rheight:320px;" width="320" height="320" imgqe="true" jsonvalue="%7B%7D" rwidth="320px" rheight="320px"></span></p><p><span style="line-height: 1.5;"><br></span></p><p>+&nbsp;내가 알고있던대로라면 웹브라우저에서 위의 주소를 쓰면 바로 내장 Player로 연결됐던 것 같은데 되지 않는다... 안드로이드는 m3u8을 다운로드하고, 아이폰은 Play 버튼은 나오는데 재생이 되지 않는다. 시간있을 때 찾아보겠음</p><p><br></p>
